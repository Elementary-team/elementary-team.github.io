
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../overview/">
      
      
        <link rel="next" href="../model/">
      
      
      <link rel="icon" href="../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.29">
    
    
      
        <title>Widget Model - Elementary</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.76a95c52.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#widgetmodels-properties" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Elementary" class="md-header__button md-logo" aria-label="Elementary" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Elementary
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Widget Model
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Elementary" class="md-nav__button md-logo" aria-label="Elementary" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    Elementary
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Libraries overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Libraries overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Elementary
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Elementary
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Widget Model
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Widget Model
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#widgetmodels-properties" class="md-nav__link">
    <span class="md-ellipsis">
      WidgetModel's properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#widgetmodels-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      WidgetModel's lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WidgetModel's lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lifecycle-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Lifecycle methods:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#widgetmodel-as-a-contract" class="md-nav__link">
    <span class="md-ellipsis">
      WidgetModel as a contract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ompleteness-of-the-state-description" class="md-nav__link">
    <span class="md-ellipsis">
      Сompleteness of the state description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-to-context" class="md-nav__link">
    <span class="md-ellipsis">
      Access to Context
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-to-widget" class="md-nav__link">
    <span class="md-ellipsis">
      Access to Widget
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#showcase-example" class="md-nav__link">
    <span class="md-ellipsis">
      Showcase Example
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElementaryModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../widget/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElementaryWidget
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recommendations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recommendations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Elementary-helper
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Elementary-helper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elementary-helper/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elementary-helper/publishers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publishers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elementary-helper/subscribers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subscribers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Elementary-test
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Elementary-test
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elementary-test/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elementary-test/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Quick Start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/qs/tooling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tooling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/qs/dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/qs/implementation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/qs/tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tests
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#widgetmodels-properties" class="md-nav__link">
    <span class="md-ellipsis">
      WidgetModel's properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#widgetmodels-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      WidgetModel's lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WidgetModel's lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lifecycle-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Lifecycle methods:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#widgetmodel-as-a-contract" class="md-nav__link">
    <span class="md-ellipsis">
      WidgetModel as a contract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ompleteness-of-the-state-description" class="md-nav__link">
    <span class="md-ellipsis">
      Сompleteness of the state description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-to-context" class="md-nav__link">
    <span class="md-ellipsis">
      Access to Context
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-to-widget" class="md-nav__link">
    <span class="md-ellipsis">
      Access to Widget
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#showcase-example" class="md-nav__link">
    <span class="md-ellipsis">
      Showcase Example
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Widget Model</h1>

<p>In the MVVM concept, the ViewModel is the workhorse: it connects the View and Model, orchestrates business processes, and contains presentation logic. This is why <code>WidgetModel</code> is the key part of the responsibility chain in Elementary.</p>
<h2 id="widgetmodels-properties">WidgetModel's properties</h2>
<p>Flutter has many internal optimizations and can be highly effective, but there’s no magic to make every code efficient; we also need to care about performance. One aspect that everyone encounters in every application is rebuilds. It is <a href="https://docs.flutter.dev/perf/best-practices#control-build-cost">crucial</a> to make them efficient. The most efficient approach is to rebuild only the parts that need to change.</p>
<p>At the same time, MVVM is convenient to use when there is binding between UI parts and ViewModel properties.</p>
<p>Based on this, Elementary aims to use properties that follow the <a href="https://refactoring.guru/design-patterns/observer">Observer</a> design pattern paradigm. In this case, a property acts as the subject (publisher). In the widget layer, we use a builder subscribed to the property, functioning as the observer (dependent/subscriber).</p>
<p><img src="https://i.ibb.co/5MVNrqN/property-rebuild.gif" alt="Property rebuild scheme"></p>
<p>There’s no mandatory requirement for which implementation of this pattern to use — it can be ChangeNotifiers, Streams, or any other preferred method. However, for your convenience, a few implementations are provided with Elementary. To find them, check the <a href="https://pub.dev/packages/elementary_helper">support library</a>.</p>
<p>Properties that are not intended to change or initiate a visual update can simply be getters or fields.</p>
<h2 id="widgetmodels-lifecycle">WidgetModel's lifecycle</h2>
<p>As mentioned earlier, the <code>WidgetModel</code> has its lifecycle synchronized with the lifecycle of the <code>Element</code> to which it belongs. If you're familiar with the lifecycle of <a href="https://api.flutter.dev/flutter/widgets/State-class.html">State</a> in a <a href="https://api.flutter.dev/flutter/widgets/StatefulWidget-class.html">StatefulWidget</a>, it will be easy for you — they are quite similar. The one significant difference is that the methods <code>didUpdateWidget</code> and <code>didChangeDependencies</code> do not automatically initiate a rebuild of the subtree. The reason for this is that Elementary aims to avoid unnecessary rebuilds, and with the property-publisher approach, you can efficiently rebuild only the parts of the UI that require updates. So, the sole purpose of these methods is to notify you that these events occur, and the final decision on what and how to rebuild is up to you.</p>
<h3 id="lifecycle-methods">Lifecycle methods:</h3>
<ul>
<li>
<p><strong><em><code>initWidgetModel</code></em></strong> is called only once in the lifecycle of the WidgetModel in the beginning (before the first build).
This method can be used to initiate a starting state of the <code>WidgetModel</code>.</p>
</li>
<li>
<p><strong><em><code>didUpdateWidget</code></em></strong> is called whenever the corresponding <code>ElementaryWidget</code> instance in the tree has been updated.
A common case is when the rebuild comes from the top of the tree. This method is a good place to actualize the state of the <code>WidgetModel</code> based on the new configuration of the widget. <em>This does not lead to a rebuild of the subtree. Please set new values to publishers for rebuilding specific parts of the UI.</em></p>
</li>
<li>
<p><strong><em><code>didChangeDependencies</code></em></strong> is called whenever the dependencies that <code>WidgetModel</code> <a href="https://api.flutter.dev/flutter/widgets/BuildContext/dependOnInheritedWidgetOfExactType.html">subscribed</a> to by BuildContext change. <em>This does not lead to a rebuild of the subtree. Please set new values to publishers for rebuilding specific parts of the UI.</em></p>
</li>
<li>
<p><strong><em><code>deactivate</code></em></strong> is called when the <code>WidgetModel</code> with <code>Elementary</code> is removed from the tree.</p>
</li>
<li>
<p><strong><em><code>activate</code></em></strong> is called when the <code>WidgetModel</code> with <code>Elementary</code> is reinserted into the tree after being removed via deactivate.</p>
</li>
<li>
<p><strong><em><code>dispose</code></em></strong> is called when the <code>WidgetModel</code> is going to be permanently destroyed.</p>
</li>
<li>
<p><strong><em><code>reassemble</code></em></strong> is called whenever the application is reassembled during debugging, for example during a hot reload.</p>
</li>
<li>
<p><strong><em><code>onErrorHandle</code></em></strong> is called when the <code>ElementaryModel</code> handles an error with the <code>ElementaryModel.handleError</code> method.
Can be useful for general handling errors, such as showing a snack bar.</p>
</li>
</ul>
<h2 id="widgetmodel-as-a-contract">WidgetModel as a contract</h2>
<p>It can be a good idea to use an interface for your <code>WidgetModel</code>s for the sake of code testability and to explicitly describe the contract that can be used during the subtree build by <code>ElementaryWidget</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1">/// An interface for [ExampleScreenWidgetModel]</span>
<span class="kd">abstract</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">IExampleScreenWidgetModel</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">IWidgetModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">/// Provides observable information about some integer value.</span>
<span class="w">  </span><span class="n">ValueListenable</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">exampleProperty</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="ompleteness-of-the-state-description">Сompleteness of the state description</h2>
<p><code>WidgetModel</code> is the source of truth for describing the subtree. This means it should provide everything required for this build. In other words, the contract of the <code>WidgetModel</code> should be a complete abstraction of what is shown on the UI. In this case, the building subtree appears to be only a declarative description by the rule <code>UI = f(S)</code>.</p>
<h2 id="access-to-context">Access to Context</h2>
<p><strong><em><code>WidgetModel</code> is the only place that has access to <code>BuildContext</code> in the triad <code>ElementaryWidget-WidgetModel-ElementaryModel</code>.</em></strong></p>
<p>There are a few reasons for this:</p>
<ul>
<li><code>WidgetModel</code> has a tight bond with the <code>Elementary</code>, which is an Element (BuildContext).</li>
<li><code>WidgetModel</code> contains everything relative to presentation logic and defining the current state =&gt; all updates by the context subscription should come there.</li>
<li><code>ElementaryModel</code> is a business logic layer. Business logic should be pure and independent from Flutter. So BuildContext is not appropriate there.</li>
<li><code>ElementaryWidget</code> should contain only a declarative description and be free from any logic. It also has the source of truth, which is <code>WidgetModel</code>.</li>
</ul>
<p>It is important to note that all this is relative only to the level when <code>ElementaryWidget</code> is used, and down-laying widgets might have access to context on their levels.</p>
<h2 id="access-to-widget">Access to Widget</h2>
<p>Respecting the general Flutter approach, <code>ElementaryWidget</code> is an immutable configuration. <code>WidgetModel</code> has access to <code>ElementaryWidget</code> at any time. This can be useful for initiating or updating <code>WidgetModel</code>'s properties.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@override</span>
<span class="kt">void</span><span class="w"> </span><span class="n">initWidgetModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">super</span><span class="p">.</span><span class="n">initWidgetModel</span><span class="p">();</span>

<span class="w">  </span><span class="n">_someProperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ValueNotifier</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">passedValue</span><span class="p">);</span>
<span class="p">}</span>

<span class="nd">@override</span>
<span class="kt">void</span><span class="w"> </span><span class="n">didUpdateWidget</span><span class="p">(</span><span class="n">TestPageWidget</span><span class="w"> </span><span class="n">oldWidget</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">super</span><span class="p">.</span><span class="n">didUpdateWidget</span><span class="p">(</span><span class="n">oldWidget</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">passedValue</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">oldWidget</span><span class="p">.</span><span class="n">passedValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_someProperty</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">passedValue</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="showcase-example">Showcase Example</h2>
<p>This is a simple example showing a case with loading data from the network. While loading, we use previous data. As a property providing this data to the UI, we use <code>EntityStateNotifier</code> - a publisher with 3 base states: content, error, and loading. For more details about the implementation of this publisher, check the <a href="https://pub.dev/packages/elementary_helper">support library</a>.</p>
<div class="highlight"><pre><span></span><code><span class="c1">/// Widget Model for [ExampleScreen]</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ExampleWidgetModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WidgetModel</span><span class="o">&lt;</span><span class="n">ExampleScreen</span><span class="p">,</span><span class="w"> </span><span class="n">ExampleModel</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">IExampleWidgetModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_exampleState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EntityStateNotifier</span><span class="o">&lt;</span><span class="n">ExampleEntity</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">ListenableState</span><span class="o">&lt;</span><span class="n">EntityState</span><span class="o">&lt;</span><span class="n">ExampleEntity</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">exampleState</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_exampleState</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initWidgetModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initWidgetModel</span><span class="p">();</span>

<span class="w">    </span><span class="n">_loadData</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadData</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">previousData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_exampleState</span><span class="p">.</span><span class="n">value</span><span class="o">?</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>
<span class="w">    </span><span class="n">_exampleState</span><span class="p">.</span><span class="n">loading</span><span class="p">(</span><span class="n">previousData</span><span class="p">);</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">loadData</span><span class="p">();</span>
<span class="w">      </span><span class="n">_exampleState</span><span class="p">.</span><span class="n">content</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kd">on</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_exampleState</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">previousData</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">/// An interface for [ExampleWidgetModel]</span>
<span class="kd">abstract</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">IExampleWidgetModel</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">IWidgetModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ListenableState</span><span class="o">&lt;</span><span class="n">EntityState</span><span class="o">&lt;</span><span class="n">ExampleEntity</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">exampleState</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Elementary-team/flutter-elementary/tree/main/packages/elementary" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/mbixjkee" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/flutter_elementary" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.tooltips"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>